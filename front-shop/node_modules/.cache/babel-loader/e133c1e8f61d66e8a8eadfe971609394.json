{"ast":null,"code":"var _jsxFileName = \"/home/seung/react/shop/front-shop/src/components/PostRegister.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport { Form, Container, Button, Row, Col } from \"react-bootstrap\";\nimport ImageUploading from \"react-images-uploading\";\nimport { CategoryDirection } from \"./CategoryBanner\";\nimport AreaButton from \"./AreaButton\";\nimport Modal from \"./Modal\";\nimport { S3Config, UploadS3 } from \"./UploadS3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction PostRegister({\n  history\n}) {\n  _s();\n\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalContents, setModalContents] = useState(\"\");\n\n  const closeModal = () => {\n    setModalOpen(false);\n  };\n\n  const [area, setArea] = useState(\"지역을 선택해 주세요\");\n  const {\n    isLoggedIn,\n    userData\n  } = useSelector(state => ({\n    isLoggedIn: state.user.isLoggedIn,\n    userData: state.user.payload\n  }));\n  const [selectedFiles, setSelectedFiles] = useState([]);\n\n  const handleFileInput = e => {\n    // setSelectedFile(selectedFile.concat(e.target.files[0]));\n    setSelectedFiles(selectedFiles.concat(e.target.files[0]));\n  };\n\n  const maxNumber = 4;\n  const [content, setContent] = useState({\n    title: \"\",\n    description: \"\"\n  });\n  const {\n    title,\n    description\n  } = content;\n\n  const onChangeHandler = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setContent({ ...content,\n      [name]: value\n    });\n  };\n\n  const onChangeArea = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setArea(value);\n  };\n\n  const onClickHandler = () => {\n    if (!(title && description)) {\n      setModalOpen(true);\n      setModalContents(\"모든 항목을 입력해 주세요\");\n      return;\n    }\n\n    if (area == undefined || area == null || area == \"지역을 선택해 주세요\") {\n      setModalOpen(true);\n      setModalContents(\"거래 지역을 선택해 주세요\");\n      return;\n    }\n\n    const body = {\n      user_id: userData.user_id,\n      title: title,\n      area: area,\n      description: description,\n      images: selectedFiles.map(image => `https://${S3Config.bucketName}.s3.${S3Config.region}.amazonaws.com/${image.name}` // ...image_list  // 용량이 크면 안넘어가\n      )\n    };\n    console.log(\"바디\", body);\n    axios.post(\"/apis/v1/post\", body).then(response => {\n      alert(\"hihi\"); // history.replace('/')\n    }).catch(e => {\n      setModalOpen(true);\n      setModalContents(\"상품 등록에 실패하였습니다. 관리자에게 문의하세요.\");\n    });\n  };\n\n  const checkLogin = () => {\n    if (!isLoggedIn || !userData) {\n      alert(\"로그인 후 이용해 주세요!\");\n      history.goBack();\n    }\n  };\n\n  useEffect(() => {\n    checkLogin();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      open: modalOpen,\n      close: closeModal,\n      children: modalContents\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(CategoryDirection, {\n        tag1: \"자유거래 게시판\",\n        tag2: \"게시글 등록하기\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: \"1.3rem\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            lg: {\n              span: 11,\n              offset: 2\n            },\n            sm: {\n              span: 12,\n              offset: 0\n            },\n            xs: {\n              span: 12\n            },\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"exampleForm.ControlInput1\",\n                as: Row,\n                children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                  column: true,\n                  sm: \"2\",\n                  lg: \"1\",\n                  xs: \"4\",\n                  children: \"\\uC81C\\uBAA9\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  sm: \"10\",\n                  lg: \"8\",\n                  xs: \"8\",\n                  children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                    name: \"title\",\n                    value: title,\n                    onChange: onChangeHandler,\n                    placeholder: \"\\uC0C1\\uD488\\uBA85\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 123,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 122,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  sm: \"2\",\n                  lg: \"1\",\n                  xs: \"4\",\n                  style: {\n                    paddingTop: 20\n                  },\n                  children: \"\\uAC70\\uB798 \\uC9C0\\uC5ED\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 133,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  sm: \"6\",\n                  lg: \"6\",\n                  xs: \"6\",\n                  style: {\n                    paddingTop: 8\n                  },\n                  children: /*#__PURE__*/_jsxDEV(AreaButton, {\n                    onChange: onChangeArea,\n                    area: area\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 137,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"exampleForm.ControlTextarea1\",\n                as: Row,\n                children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                  column: true,\n                  sm: \"2\",\n                  lg: \"1\",\n                  children: \"\\uB0B4\\uC6A9\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  sm: \"10\",\n                  lg: \"8\",\n                  children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                    as: \"textarea\",\n                    rows: 5,\n                    onChange: onChangeHandler,\n                    name: \"description\",\n                    placeholder: \"\\uC0C1\\uD488 \\uC124\\uBA85\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694\",\n                    value: description\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 146,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"exampleForm.ControlTextarea1\",\n                as: Row,\n                children: /*#__PURE__*/_jsxDEV(Col, {\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    onChange: handleFileInput\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 159,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: `이미지는 최대 ${maxNumber}개까지만 첨부할 수 있습니다`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 162,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                type: \"submit\",\n                variant: \"outline-light\",\n                style: {\n                  background: \"#e85255\",\n                  fontSize: \"1.3rem\"\n                },\n                onClick: e => {\n                  e.preventDefault();\n                  onClickHandler();\n                  UploadS3(selectedFiles);\n                },\n                children: \"\\uAC8C\\uC2DC\\uAE00 \\uB4F1\\uB85D\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PostRegister, \"/FY5o53+t8ldtaYpDolT38IgWpE=\", false, function () {\n  return [useSelector];\n});\n\n_c = PostRegister;\nexport default PostRegister;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostRegister\");","map":{"version":3,"sources":["/home/seung/react/shop/front-shop/src/components/PostRegister.js"],"names":["React","useEffect","useState","useSelector","useDispatch","axios","Form","Container","Button","Row","Col","ImageUploading","CategoryDirection","AreaButton","Modal","S3Config","UploadS3","PostRegister","history","modalOpen","setModalOpen","modalContents","setModalContents","closeModal","area","setArea","isLoggedIn","userData","state","user","payload","selectedFiles","setSelectedFiles","handleFileInput","e","concat","target","files","maxNumber","content","setContent","title","description","onChangeHandler","name","value","onChangeArea","onClickHandler","undefined","body","user_id","images","map","image","bucketName","region","console","log","post","then","response","alert","catch","checkLogin","goBack","fontSize","span","offset","paddingTop","background","preventDefault"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport { Form, Container, Button, Row, Col } from \"react-bootstrap\";\nimport ImageUploading from \"react-images-uploading\";\nimport { CategoryDirection } from \"./CategoryBanner\";\nimport AreaButton from \"./AreaButton\";\nimport Modal from \"./Modal\";\nimport { S3Config, UploadS3 } from \"./UploadS3\";\n\nfunction PostRegister({ history }) {\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalContents, setModalContents] = useState(\"\");\n  const closeModal = () => {\n    setModalOpen(false);\n  };\n  const [area, setArea] = useState(\"지역을 선택해 주세요\");\n  const { isLoggedIn, userData } = useSelector((state) => ({\n    isLoggedIn: state.user.isLoggedIn,\n    userData: state.user.payload,\n  }));\n\n  const [selectedFiles, setSelectedFiles] = useState([]);\n  const handleFileInput = (e) => {\n    // setSelectedFile(selectedFile.concat(e.target.files[0]));\n    setSelectedFiles(selectedFiles.concat(e.target.files[0]));\n  };\n  const maxNumber = 4;\n\n  const [content, setContent] = useState({\n    title: \"\",\n    description: \"\",\n  });\n  const { title, description } = content;\n\n  const onChangeHandler = (e) => {\n    const { name, value } = e.target;\n    setContent({\n      ...content,\n      [name]: value,\n    });\n  };\n\n  const onChangeArea = (e) => {\n    const { name, value } = e.target;\n    setArea(value);\n  };\n\n  const onClickHandler = () => {\n    if (!(title && description)) {\n      setModalOpen(true);\n      setModalContents(\"모든 항목을 입력해 주세요\");\n      return;\n    }\n\n    if (area == undefined || area == null || area == \"지역을 선택해 주세요\") {\n      setModalOpen(true);\n      setModalContents(\"거래 지역을 선택해 주세요\");\n      return;\n    }\n\n    const body = {\n      user_id: userData.user_id,\n      title: title,\n      area: area,\n      description: description,\n      images: selectedFiles.map(\n        (image) =>\n          `https://${S3Config.bucketName}.s3.${S3Config.region}.amazonaws.com/${image.name}`\n        // ...image_list  // 용량이 크면 안넘어가\n      ),\n    };\n\n    console.log(\"바디\", body);\n    axios\n      .post(\"/apis/v1/post\", body)\n      .then((response) => {\n        alert(\"hihi\");\n        // history.replace('/')\n      })\n      .catch((e) => {\n        setModalOpen(true);\n        setModalContents(\"상품 등록에 실패하였습니다. 관리자에게 문의하세요.\");\n      });\n  };\n\n  const checkLogin = () => {\n    if (!isLoggedIn || !userData) {\n      alert(\"로그인 후 이용해 주세요!\");\n      history.goBack();\n    }\n  };\n\n  useEffect(() => {\n    checkLogin();\n  }, []);\n\n  return (\n    <div>\n      <Modal open={modalOpen} close={closeModal}>\n        {modalContents}\n      </Modal>\n\n      <Container>\n        <CategoryDirection\n          tag1={\"자유거래 게시판\"}\n          tag2={\"게시글 등록하기\"}\n        ></CategoryDirection>\n        <br />\n        <div style={{ fontSize: \"1.3rem\" }}>\n          <Row>\n            <Col\n              lg={{ span: 11, offset: 2 }}\n              sm={{ span: 12, offset: 0 }}\n              xs={{ span: 12 }}\n            >\n              <Form>\n                <Form.Group controlId=\"exampleForm.ControlInput1\" as={Row}>\n                  <Form.Label column sm=\"2\" lg=\"1\" xs=\"4\">\n                    제목\n                  </Form.Label>\n                  <Col sm=\"10\" lg=\"8\" xs=\"8\">\n                    <Form.Control\n                      name=\"title\"\n                      value={title}\n                      onChange={onChangeHandler}\n                      placeholder=\"상품명을 적어주세요\"\n                    />\n                  </Col>\n                </Form.Group>\n\n                <Row>\n                  <Col sm=\"2\" lg=\"1\" xs=\"4\" style={{ paddingTop: 20 }}>\n                    거래 지역\n                  </Col>\n                  <Col sm=\"6\" lg=\"6\" xs=\"6\" style={{ paddingTop: 8 }}>\n                    <AreaButton onChange={onChangeArea} area={area} />\n                  </Col>\n                </Row>\n                <br />\n                <Form.Group controlId=\"exampleForm.ControlTextarea1\" as={Row}>\n                  <Form.Label column sm=\"2\" lg=\"1\">\n                    내용\n                  </Form.Label>\n                  <Col sm=\"10\" lg=\"8\">\n                    <Form.Control\n                      as=\"textarea\"\n                      rows={5}\n                      onChange={onChangeHandler}\n                      name=\"description\"\n                      placeholder=\"상품 설명을 적어주세요\"\n                      value={description}\n                    />\n                  </Col>\n                </Form.Group>\n                <br />\n                <Form.Group controlId=\"exampleForm.ControlTextarea1\" as={Row}>\n                  <Col>\n                    <input type=\"file\" onChange={handleFileInput} />\n                    {/* <button onClick={(e) => emptyFiles(e)}>Empty</button> */}\n\n                    <p>\n                      {`이미지는 최대 ${maxNumber}개까지만 첨부할 수 있습니다`}\n                    </p>\n                    <br />\n                  </Col>\n                </Form.Group>\n                <Button\n                  type=\"submit\"\n                  variant=\"outline-light\"\n                  style={{ background: \"#e85255\", fontSize: \"1.3rem\" }}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    onClickHandler();\n                    UploadS3(selectedFiles);\n                  }}\n                >\n                  게시글 등록\n                </Button>\n              </Form>\n            </Col>\n          </Row>\n        </div>\n      </Container>\n    </div>\n  );\n}\n\nexport default PostRegister;\n"]},"metadata":{},"sourceType":"module"}